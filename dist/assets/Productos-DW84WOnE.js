import{u as k,j as e,a as E,r as o}from"./index-BS7yygty.js";import{C as R}from"./Data_Catalogo-BValZcSX.js";import{A as T}from"./AlertaSimple-Cz13oxos.js";import{N as J,F as O}from"./Footer-BY6JQjk0.js";function z({producto:t,onAddToCart:j}){const c=k(),l=()=>{c(`/producto/${t.id}`)};return e.jsxs("div",{className:"producto-card card shadow-sm",style:{cursor:"pointer"},onClick:l,children:[e.jsx("img",{src:t.imagen,alt:t.nombre,className:"card-img-top"}),e.jsxs("div",{className:"card-body text-center",children:[e.jsx("h5",{className:"card-title",children:t.nombre}),e.jsxs("p",{className:"card-text fw-bold",children:["$",t.precio.toLocaleString()]}),e.jsx("button",{className:"btn btn-primary mt-auto",onClick:d=>{d.stopPropagation(),j(t)},children:"Agregar al carrito"})]})]})}function W(){const t=E(),c=new URLSearchParams(t.search).get("categoria");k();const{catalogo:l}=R(),[d,A]=o.useState([]),[s,g]=o.useState(1),x=8,[h,N]=o.useState(!0),[r,w]=o.useState(null),[p,f]=o.useState(1),[M,m]=o.useState(!1),[y,u]=o.useState({msg:"",type:""});o.useEffect(()=>{N(!0);const a=setTimeout(()=>{const n=c?l.filter(i=>i.categoria===c):l;A(n),g(1),N(!1)},800);return()=>clearTimeout(a)},[c,l]);const v=(s-1)*x,F=v+x,C=d.slice(v,F),b=Math.ceil(d.length/x),L=()=>e.jsx("div",{className:"col-12 col-sm-6 col-md-4 col-lg-3 d-flex",children:e.jsxs("div",{className:"card placeholder-glow",style:{width:"18rem",height:"300px"},children:[e.jsx("div",{className:"card-img-top placeholder",style:{height:"180px"}}),e.jsxs("div",{className:"card-body",children:[e.jsx("h5",{className:"card-title",children:e.jsx("span",{className:"placeholder col-6"})}),e.jsxs("p",{className:"card-text",children:[e.jsx("span",{className:"placeholder col-7"}),e.jsx("span",{className:"placeholder col-4"})]}),e.jsx("a",{className:"btn btn-primary disabled placeholder col-6"})]})]})}),S=()=>{s<b&&g(s+1)},P=()=>{s>1&&g(s-1)},I=a=>{w(a),f(1),m(!0)},$=()=>{if(!r){u({msg:"Debes seleccionar un producto antes de agregar al carrito.",type:"warning"});return}const a={id:r.id,nombre:r.nombre,precio:r.precio,imagen:r.imagen,cantidad:p},n=JSON.parse(localStorage.getItem("cart"))||[],i=n.find(q=>q.id===a.id);i?(i.cantidad=Math.min(i.cantidad+p,8),u({msg:`${a.nombre} ya estaba en el carrito. Cantidad actualizada.`,type:"info"})):(n.push(a),u({msg:`${a.nombre} agregado al carrito.`,type:"success"})),localStorage.setItem("cart",JSON.stringify(n)),m(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(J,{}),e.jsx(T,{message:y.msg,type:y.type,onClose:()=>u({msg:"",type:""})}),e.jsxs("div",{id:"banner-contacto",children:[e.jsx("img",{src:"/assets/img/Banner/productos.webp",alt:"Pastelería Wonderland",className:"banner opacity-75"}),e.jsx("p",{id:"letra-b-producto",children:c||"Nuestros Productos"})]}),!h&&e.jsxs("div",{className:"d-flex justify-content-center mt-4 mb-2 gap-2",children:[e.jsx("button",{className:"btn btn-outline-secondary btn-sm",onClick:P,disabled:s===1,children:"« Anterior"}),e.jsx("button",{className:"btn btn-outline-secondary btn-sm",onClick:S,disabled:s===b,children:"Siguiente »"})]}),e.jsxs("main",{className:"container mt-4",children:[e.jsx("div",{id:"productos-container",className:"row g-3 justify-content-center",style:{maxHeight:"70vh",overflowY:"auto",paddingRight:"10px"},children:h?Array.from({length:8}).map((a,n)=>e.jsx(L,{},n)):C.length>0?C.map(a=>e.jsx("div",{className:"col-12 col-sm-6 col-md-4 col-lg-3 d-flex",children:e.jsx(z,{producto:a,onAddToCart:()=>I(a)})},a.id)):e.jsx("p",{children:"No hay productos disponibles."})}),!h&&e.jsxs("div",{className:"d-flex justify-content-center mt-3 gap-2",children:[e.jsx("button",{className:"btn btn-outline-secondary btn-sm",onClick:P,disabled:s===1,children:"« Anterior"}),e.jsx("button",{className:"btn btn-outline-secondary btn-sm",onClick:S,disabled:s===b,children:"Siguiente »"})]})]}),M&&e.jsx("div",{className:"modal fade show",style:{display:"block",background:"rgba(0,0,0,0.5)"},children:e.jsx("div",{className:"modal-dialog",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("h5",{className:"modal-title",children:["Agregar ",r?.nombre]}),e.jsx("button",{type:"button",className:"btn-close",onClick:()=>{m(!1),document.body.classList.remove("modal-open");const a=document.querySelector(".modal-backdrop");a&&a.remove()}})]}),e.jsxs("div",{className:"modal-body text-center",children:[e.jsx("p",{children:"Selecciona la cantidad (máx. 8):"}),e.jsx("input",{type:"number",min:"1",max:"8",value:p,onChange:a=>f(Math.min(Math.max(Number(a.target.value),1),8)),className:"form-control w-50 mx-auto text-center"})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>m(!1),children:"Cancelar"}),e.jsx("button",{className:"btn btn-success",onClick:$,children:"Confirmar"})]})]})})}),e.jsx(O,{})]})}export{W as default};
