import{j as e,r as c,L as m}from"./index-Dh3LGQB_.js";import{A as g}from"./AlertaSimple-DCFDxQxL.js";import{N as b,F as N}from"./Footer-DYz7OeN0.js";function f({item:a,onIncrease:n,onDecrease:d,onRemove:i}){const l=a.precio*a.cantidad;return e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{className:"d-flex align-items-center",children:[a.imagen&&e.jsx("img",{src:a.imagen,alt:a.nombre,className:"me-3 rounded",style:{width:"60px",height:"60px",objectFit:"cover"}}),e.jsx("span",{children:a.nombre})]})}),e.jsxs("td",{children:["$",a.precio.toLocaleString("es-CL")]}),e.jsx("td",{className:"cantidad-td bg-transparent",children:e.jsxs("div",{className:"d-flex align-items-center justify-content-center",children:[e.jsx("button",{className:"btn btn-sm btn-outline-secondary",onClick:()=>d(a.id),title:"Disminuir cantidad",children:"−"}),e.jsx("span",{className:"mx-3 fw-semibold",children:a.cantidad}),e.jsx("button",{className:"btn btn-sm btn-outline-secondary",onClick:()=>n(a.id),title:"Aumentar cantidad",children:"+"})]})}),e.jsxs("td",{children:["$",l.toLocaleString("es-CL")]}),e.jsx("td",{className:"text-center",children:e.jsxs("button",{className:"btn btn-sm btn-outline-danger",onClick:()=>i(a.id),title:"Eliminar producto",children:[e.jsx("i",{className:"bi bi-trash"})," Eliminar"]})})]})}function S(){const[a,n]=c.useState([]),[d,i]=c.useState(0),[l,o]=c.useState({msg:"",type:""});c.useRef(!1),c.useEffect(()=>{const s=localStorage.getItem("cart");if(s){const r=JSON.parse(s);console.log("Carrito cargado (solo una vez):",r),n(r)}else console.log("No hay carrito guardado")},[]),c.useEffect(()=>{if(a.length==0)return;const s=a.reduce((r,t)=>r+t.precio*t.cantidad,0);i(s),localStorage.setItem("cart",JSON.stringify(a))},[a]);const h=s=>{n(r=>r.map(t=>t.id===s&&t.cantidad<8?{...t,cantidad:t.cantidad+1}:t))},x=s=>{n(r=>r.map(t=>t.id===s?{...t,cantidad:Math.max(t.cantidad-1,0)}:t).filter(t=>t.cantidad>0))},u=s=>{n(r=>r.filter(t=>t.id!==s)),o({msg:"Producto eliminado del carrito",type:"info"})},p=()=>{if(a.length===0){o({msg:"Tu carrito ya está vacío",type:"info"});return}localStorage.removeItem("cart"),n([]),i(0),o({msg:"Carrito eliminado con éxito",type:"success"})},j=()=>{if(a.length===0){o({msg:"Tu carrito está vacío. Agrega productos antes de comprar.",type:"warning"});return}};return e.jsxs(e.Fragment,{children:[e.jsx(b,{}),e.jsx(g,{message:l.msg,type:l.type,onClose:()=>o({msg:"",type:""})}),e.jsx("img",{src:"/assets/img/Banner/pedido.webp",alt:"Pastelería Wonderland",className:"banner"}),e.jsxs("div",{className:"custom-alert soft",children:["¿Eres cliente? ",e.jsx(m,{to:"/login",className:"alert-link",children:"Haz clic aquí para acceder"})]}),e.jsx("div",{className:"custom-alert soft",children:e.jsx("p",{children:"Si tienes un cupón, se aplica al finalizar tu compra "})}),e.jsx("section",{id:"Carrito",className:"container my-5",children:e.jsxs("div",{className:"card p-4 shadow",children:[e.jsx("h2",{className:"mb-4",children:"Carro de Compras"}),e.jsxs("table",{className:"table table-striped table-hover shadow-sm rounded",children:[e.jsx("thead",{className:"table-responsive",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Producto"}),e.jsx("th",{children:"Precio unitario"}),e.jsx("th",{children:"Cantidad"}),e.jsx("th",{children:"Subtotal"}),e.jsx("th",{children:"Acción"})]})}),e.jsx("tbody",{children:a.length>0?a.map(s=>e.jsx(f,{item:s,onIncrease:h,onDecrease:x,onRemove:u},s.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center",children:"Tu carro de compras está vacío."})})})]}),e.jsxs("div",{className:"text-end mt-3",children:[e.jsx(m,{to:"/productos",className:"btn btn-primary text-decoration-none",children:"Seguir Comprando"}),e.jsx("button",{type:"reset",className:"btn btn-danger",onClick:p,children:"Eliminar carrito"}),e.jsx("button",{type:"success",className:"btn btn-success",onClick:j,children:"Finalizar Compra"}),e.jsxs("h4",{className:"mt-3 fw-bold text-secondary",children:["Total: $",d.toLocaleString("es-CL")]})]})]})}),e.jsx(N,{})]})}export{S as default};
