import{j as e,r as c,u as y}from"./index-BS7yygty.js";function S({toggleOffcanvas:l}){return e.jsx("header",{className:"navbar bg-white border-bottom sticky-top",children:e.jsxs("div",{className:"container-fluid d-flex justify-content-between align-items-center",children:[e.jsxs("h1",{className:"navbar-brand fw-semibold",children:[e.jsx("i",{className:"bi bi-cupcake me-2"})," Pastelería Wonderland • Administración"]}),e.jsx("button",{className:"btn btn-outline-secondary ms-auto",onClick:l,children:e.jsx("i",{className:"bi bi-list"})})]})})}function w({visible:l,toggleOffcanvas:t,handleAgregarEmpleado:i,handleEditarEmpleado:a,empleadoSeleccionado:s,handleAgregarProducto:r,logout:d,setTabActivo:n,abrirPerfil:h}){return e.jsxs("div",{"data-testid":"sidebar-admin",className:`offcanvas offcanvas-end ${l?"show":""}`,style:{visibility:l?"visible":"hidden",width:"280px"},children:[e.jsxs("div",{className:"offcanvas-header",children:[e.jsx("h5",{className:"offcanvas-title",children:"Cuenta"}),e.jsx("button",{className:"btn-close",onClick:t,"aria-label":"Cerrar barra"})]}),e.jsxs("div",{className:"offcanvas-body d-flex flex-column p-0",children:[e.jsx("div",{className:"px-3 pt-2 pb-1 small text-uppercase text-muted",children:"Inicio"}),e.jsx("nav",{className:"list-group list-group-flush mb-2",children:e.jsxs("button",{className:"list-group-item list-group-item-action",onClick:()=>{n("bandeja"),t()},children:[e.jsx("i",{className:"bi bi-house-door me-2"})," Home"]})}),e.jsx("div",{className:"px-3 pt-2 pb-1 small text-uppercase text-muted",children:"Gestión de productos"}),e.jsxs("nav",{className:"list-group list-group-flush mb-2",children:[e.jsxs("button",{className:"list-group-item list-group-item-action",onClick:()=>{r(),t()},children:[e.jsx("i",{className:"bi bi-plus-circle me-2"})," Agregar"]}),e.jsxs("button",{className:"list-group-item list-group-item-action",onClick:()=>{n("editarProducto"),t()},children:[e.jsx("i",{className:"bi bi-pencil-square me-2"})," Modificar"]}),e.jsxs("button",{className:"list-group-item list-group-item-action",onClick:()=>{n("productos"),t()},children:[e.jsx("i",{className:"bi bi-table me-2"})," Mostrar"]}),e.jsxs("button",{className:"list-group-item list-group-item-action",onClick:()=>{n("topProductos"),t()},children:[e.jsx("i",{className:"bi bi-bar-chart me-2"})," Top 10 Productos"]})]}),e.jsx("div",{className:"px-3 pt-3 pb-1 small text-uppercase text-muted",children:"Gestión de empleados"}),e.jsxs("nav",{className:"list-group list-group-flush mb-2",children:[e.jsxs("button",{className:"list-group-item list-group-item-action",onClick:()=>{i(),n("empleados"),t()},children:[e.jsx("i",{className:"bi bi-person-plus me-2"})," Agregar"]}),e.jsxs("button",{className:"list-group-item list-group-item-action",onClick:()=>{a(s),n("empleados"),t()},children:[e.jsx("i",{className:"bi bi-person-gear me-2"})," Modificar"]}),e.jsxs("button",{className:"list-group-item list-group-item-action",onClick:()=>{n("empleados"),t()},children:[e.jsx("i",{className:"bi bi-people me-2"})," Mostrar"]})]}),e.jsx("div",{className:"px-3 pt-3 pb-1 small text-uppercase text-muted",children:"Funcionalidades"}),e.jsxs("nav",{className:"list-group list-group-flush mb-2",children:[e.jsxs("button",{className:"list-group-item list-group-item-action",onClick:()=>h(),children:[e.jsx("i",{className:"bi bi-person-circle me-2"})," Perfil Administrador"]}),e.jsxs("button",{className:"list-group-item list-group-item-action",children:[e.jsx("i",{className:"bi bi-shield-lock me-2"})," Seguridad"]})]}),e.jsx("div",{className:"mt-auto p-3 border-top",children:e.jsxs("button",{className:"btn w-100 btn-outline-danger",onClick:d,children:[e.jsx("i",{className:"bi bi-box-arrow-right me-2"})," Cerrar sesión"]})})]})]})}function P(){const[l,t]=c.useState([]),[i,a]=c.useState(null);return c.useEffect(()=>{fetch("/mensajes.json").then(s=>s.json()).then(s=>{!s||s.length===0?t([{fecha:new Date().toLocaleDateString(),nombre:"Torta de matrimonio",correo:"fran@duocuc.cl",orden:"-",mensaje:"Necesitamos una torta de boda muy grande, de tres pisos, con decoración elegante y flores comestibles. El evento será el 15 de diciembre y necesitamos que la entrega sea puntual en la iglesia central. Además, queremos que tenga sabor vainilla con relleno de frambuesa en todos los pisos. Por favor, confirmen disponibilidad y precio."}]):t(s)}).catch(()=>{t([{fecha:new Date().toLocaleDateString(),nombre:"Torta de matrimonio",correo:"fran@duocuc.cl",orden:"-",mensaje:"Necesitamos una torta de boda muy grande, de tres pisos, con decoración elegante y flores comestibles. El evento será el 15 de diciembre y necesitamos que la entrega sea puntual en la iglesia central. Además, queremos que tenga sabor vainilla con relleno de frambuesa en todos los pisos. Por favor, confirmen disponibilidad y precio."}])})},[]),e.jsxs("div",{children:[e.jsx("h2",{className:"h4 mb-3",children:"Bandeja de contacto"}),e.jsx("p",{className:"text-muted",children:"Mensajes recibidos desde el formulario."}),e.jsx("div",{className:"card shadow-sm",children:e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-hover align-middle mb-0",children:[e.jsx("thead",{className:"table-light",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Fecha"}),e.jsx("th",{children:"Nombre"}),e.jsx("th",{children:"Correo"}),e.jsx("th",{children:"Orden"}),e.jsx("th",{children:"Mensaje"}),e.jsx("th",{children:"Acción"})]})}),e.jsx("tbody",{children:l.map((s,r)=>e.jsxs("tr",{children:[e.jsx("td",{children:s.fecha}),e.jsx("td",{children:s.nombre}),e.jsx("td",{children:s.correo}),e.jsx("td",{children:s.orden||"-"}),e.jsx("td",{children:s.mensaje.length>50?s.mensaje.substring(0,50)+"...":s.mensaje}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-sm btn-outline-primary",onClick:()=>a(s),children:"Ver completo"})})]},r))})]})})}),i&&e.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:9999},onClick:()=>a(null),children:e.jsxs("div",{style:{backgroundColor:"#fff",padding:"1.5rem",borderRadius:"8px",maxWidth:"600px",width:"90%",maxHeight:"80%",overflowY:"auto",boxShadow:"0 0 10px rgba(0,0,0,0.3)"},onClick:s=>s.stopPropagation(),children:[e.jsxs("h5",{children:["Mensaje de ",i.nombre]}),e.jsx("p",{children:i.mensaje}),e.jsx("div",{className:"text-end",children:e.jsx("button",{className:"btn btn-secondary btn-sm",onClick:()=>a(null),children:"Cerrar"})})]})})]})}function k({productoEdit:l,handleGuardarProducto:t,setFormVisibleProducto:i}){const a=["Tortas Cuadradas","Tortas Circulares","Postres Individuales","Productos Sin Azúcar","Pastelería Tradicional","Productos Sin Gluten","Productos Veganos","Tortas Especiales"],[s,r]=c.useState(l?.nombre||""),[d,n]=c.useState(l?.precio||""),[h,x]=c.useState(l?.categoria||"Tortas Cuadradas"),[o,b]=c.useState(l?.imagen||""),[j,p]=c.useState(null);return e.jsxs("section",{className:"card shadow-sm p-3 mt-3",children:[e.jsx("h5",{children:l?"Editar Producto":"Agregar Producto"}),e.jsxs("form",{onSubmit:t,"data-testid":"form-producto",children:[e.jsxs("div",{className:"row g-2",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{htmlFor:"nombre",className:"form-label",children:"Nombre"}),e.jsx("input",{id:"nombre",name:"nombre",type:"text",className:"form-control",value:s,onChange:m=>r(m.target.value),required:!0})]}),e.jsxs("div",{className:"col-md-3",children:[e.jsx("label",{htmlFor:"precio",className:"form-label",children:"Precio"}),e.jsx("input",{id:"precio",name:"precio",type:"number",className:"form-control",value:d,onChange:m=>n(m.target.value),required:!0})]}),e.jsxs("div",{className:"col-md-3",children:[e.jsx("label",{htmlFor:"categoria",className:"form-label",children:"Categoría"}),e.jsx("select",{id:"categoria",name:"categoria",className:"form-select",value:h,onChange:m=>x(m.target.value),required:!0,children:a.map(m=>e.jsx("option",{value:m,children:m},m))})]})]}),e.jsxs("div",{className:"row g-2 mt-2",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{htmlFor:"imagen_url",className:"form-label",children:"Imagen (URL)"}),e.jsx("input",{id:"imagen_url",name:"imagen_url",type:"text",className:"form-control",value:o,onChange:m=>b(m.target.value)})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{htmlFor:"imagen_archivo",className:"form-label",children:"Imagen (Archivo)"}),e.jsx("input",{id:"imagen_archivo",name:"imagen_archivo",type:"file",className:"form-control",onChange:m=>p(m.target.files[0])})]})]}),e.jsxs("div",{className:"mt-3 d-flex justify-content-end",children:[e.jsx("button",{type:"button",className:"btn btn-outline-secondary me-2","data-testid":"btn-cancelar",onClick:()=>i(!1),children:"Cancelar"}),e.jsx("button",{type:"submit",className:"btn btn-primary","data-testid":"btn-guardar",children:"Guardar"})]})]})]})}function A({empleadoEdit:l,handleGuardar:t,cancelar:i}){const[a,s]=c.useState({rut:"",dv:"",nombres:"",apellido1:"",apellido2:"",correo:"",telefono:"",cargo:"",direccion:"",fecha_nacimiento:""});c.useEffect(()=>{s(l||{rut:"",dv:"",nombres:"",apellido1:"",apellido2:"",correo:"",telefono:"",cargo:"",direccion:"",fecha_nacimiento:""})},[l]);const r=n=>{const{name:h,value:x}=n.target;s(o=>({...o,[h]:x}))},d=n=>{n.preventDefault(),t(a)};return e.jsxs("section",{className:"card shadow-sm p-3 mt-3",children:[e.jsx("h5",{children:l?"Editar Empleado":"Agregar Empleado"}),e.jsxs("form",{onSubmit:d,children:[e.jsxs("div",{className:"row g-2",children:[e.jsxs("div",{className:"col-md-4",children:[e.jsx("label",{htmlFor:"rut",className:"form-label",children:"RUT"}),e.jsx("input",{id:"rut",name:"rut",type:"text",className:"form-control",value:a.rut,onChange:r,disabled:!!l,required:!0})]}),e.jsxs("div",{className:"col-md-2",children:[e.jsx("label",{htmlFor:"dv",className:"form-label",children:"DV"}),e.jsx("input",{id:"dv",name:"dv",type:"text",className:"form-control",value:a.dv,onChange:r,disabled:!!l,required:!0})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{htmlFor:"nombres",className:"form-label",children:"Nombres"}),e.jsx("input",{id:"nombres",name:"nombres",type:"text",className:"form-control",value:a.nombres,onChange:r,required:!0})]})]}),e.jsxs("div",{className:"row g-2 mt-2",children:[e.jsxs("div",{className:"col-md-4",children:[e.jsx("label",{htmlFor:"apellido1",className:"form-label",children:"Apellido 1"}),e.jsx("input",{id:"apellido1",name:"apellido1",type:"text",className:"form-control",value:a.apellido1,onChange:r,required:!0})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsx("label",{htmlFor:"apellido2",className:"form-label",children:"Apellido 2"}),e.jsx("input",{id:"apellido2",name:"apellido2",type:"text",className:"form-control",value:a.apellido2,onChange:r,required:!0})]}),e.jsxs("div",{className:"col-md-4",children:[e.jsx("label",{htmlFor:"correo",className:"form-label",children:"Correo"}),e.jsx("input",{id:"correo",name:"correo",type:"email",className:"form-control",value:a.correo,onChange:r,required:!0})]})]}),e.jsxs("div",{className:"row g-2 mt-2",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{htmlFor:"telefono",className:"form-label",children:"Teléfono"}),e.jsx("input",{id:"telefono",name:"telefono",type:"text",className:"form-control",value:a.telefono,onChange:r})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{htmlFor:"cargo",className:"form-label",children:"Cargo"}),e.jsx("input",{id:"cargo",name:"cargo",type:"text",className:"form-control",value:a.cargo,onChange:r})]})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{htmlFor:"direccion",className:"form-label",children:"Dirección"}),e.jsx("input",{id:"direccion",name:"direccion",type:"text",className:"form-control",value:a.direccion,onChange:r})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{htmlFor:"fecha_nacimiento",className:"form-label",children:"Fecha de nacimiento"}),e.jsx("input",{id:"fecha_nacimiento",name:"fecha_nacimiento",type:"date",className:"form-control",value:a.fecha_nacimiento,onChange:r})]}),e.jsxs("div",{className:"mt-3 d-flex justify-content-end",children:[e.jsx("button",{type:"button",className:"btn btn-outline-secondary me-2",onClick:i,children:"Cancelar"}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Guardar"})]})]})]})}function E({empleados:l,setEmpleados:t}){const[i,a]=c.useState("mostrar"),[s,r]=c.useState(null),d=()=>{r(null),a("agregar")},n=o=>{if(!o)return alert("Selecciona un empleado de la tabla primero");r(o),a("editar")},h=()=>a("mostrar"),x=o=>{const b={...o,apellidos:`${o.apellido1} ${o.apellido2}`.trim()};t(i==="editar"?l.map(j=>j.rut===o.rut?b:j):[...l,b]),r(b),a("editar")};return e.jsxs("div",{className:"d-flex",children:[(i==="agregar"||i==="editar")&&e.jsx("div",{className:"bg-white shadow-sm p-3 border rounded flex-shrink-0",style:{width:"350px",maxHeight:"80vh",overflowY:"auto",transition:"all 0.3s"},children:e.jsx(A,{empleadoEdit:s,handleGuardar:x,cancelar:h})}),e.jsxs("div",{className:"flex-grow-1 ms-3",children:[e.jsx("h2",{className:"h4 mb-3",children:"Administración de Empleados"}),e.jsxs("div",{className:"d-flex gap-2 mb-3",children:[e.jsx("button",{className:"btn btn-primary",onClick:d,children:"Agregar"}),e.jsx("button",{className:"btn btn-secondary",onClick:()=>n(s),children:"Modificar"}),e.jsx("button",{className:"btn btn-outline-secondary",onClick:h,children:"Mostrar"})]}),e.jsx("div",{className:"card shadow-sm mt-3",children:e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-hover align-middle mb-0",children:[e.jsx("thead",{className:"table-light",children:e.jsxs("tr",{children:[e.jsx("th",{children:"RUT"}),e.jsx("th",{children:"Nombres"}),e.jsx("th",{children:"Apellidos"}),e.jsx("th",{children:"Cargo"}),e.jsx("th",{children:"Correo"}),e.jsx("th",{children:"Acciones"})]})}),e.jsx("tbody",{children:l.length>0?l.map(o=>e.jsxs("tr",{onClick:()=>r(o),style:{cursor:"pointer",backgroundColor:s?.rut===o.rut?"#f0f0f0":"transparent"},children:[e.jsx("td",{children:o.rut}),e.jsx("td",{children:o.nombres}),e.jsx("td",{children:o.apellidos}),e.jsx("td",{children:o.cargo}),e.jsx("td",{children:o.correo}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-sm btn-outline-primary",onClick:()=>n(o),children:"Editar"})})]},o.rut)):e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center text-muted",children:"No hay empleados"})})})]})})})]})]})}function F(){const l={nombre:"Taylor Swift",correo:"admin@wonderland.cl",telefono:"+56998765432"},[t,i]=c.useState(l),[a,s]=c.useState(!1),r=n=>{const{name:h,value:x}=n.target;i(o=>({...o,[h]:x}))},d=n=>{n.preventDefault(),s(!1),alert("Perfil actualizado correctamente ✅")};return e.jsxs("div",{className:"card shadow-sm p-4","data-testid":"perfil-admin",children:[e.jsx("h2",{className:"h5 mb-3",children:"Perfil Administrador"}),e.jsx("p",{className:"text-muted mb-4",children:"Administra tu información de contacto y credenciales principales."}),e.jsxs("form",{onSubmit:d,children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label fw-semibold",children:"Nombre"}),e.jsx("input",{type:"text",name:"nombre",className:"form-control",value:t.nombre,onChange:r,disabled:!a})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label fw-semibold",children:"Correo"}),e.jsx("input",{type:"email",name:"correo",className:"form-control",value:t.correo,onChange:r,disabled:!a})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label fw-semibold",children:"Teléfono"}),e.jsx("input",{type:"text",name:"telefono",className:"form-control",value:t.telefono,onChange:r,disabled:!a})]}),e.jsx("div",{className:"d-flex justify-content-end",children:a?e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",className:"btn btn-outline-secondary me-2",onClick:()=>s(!1),children:"Cancelar"}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Guardar"})]}):e.jsx("button",{type:"button",className:"btn btn-skin",onClick:()=>s(!0),children:"Editar Perfil"})})]})]})}function q(){const[l,t]=c.useState([]);return c.useEffect(()=>{const s=(JSON.parse(localStorage.getItem("catalogoProductos"))||[]).map(r=>({...r,ventasSemanales:Math.floor(Math.random()*56)+5})).slice(0,10);t(s)},[]),e.jsxs("div",{className:"container mt-4",children:[e.jsxs("h2",{className:"text-center mb-4",children:[e.jsx("span",{style:{display:"inline-block",marginRight:"8px"},children:"🍰"}),"Top 10 Productos Críticos"]}),e.jsx("div",{className:"d-flex flex-row overflow-auto p-3 gap-3",style:{border:"1px solid #ddd",borderRadius:"12px",backgroundColor:"#fff",boxShadow:"0 2px 6px rgba(0,0,0,0.1)",scrollBehavior:"smooth"},children:l.length>0?l.map((i,a)=>e.jsxs("div",{className:"p-3 text-center",style:{minWidth:"250px",border:"1px solid #e0e0e0",borderRadius:"10px",backgroundColor:"#fdfaf9",transition:"transform 0.2s ease"},onMouseEnter:s=>s.currentTarget.style.transform="scale(1.05)",onMouseLeave:s=>s.currentTarget.style.transform="scale(1)",children:[e.jsxs("h5",{className:"mb-2 text-primary",children:["#",a+1]}),e.jsx("img",{src:i.imagen,alt:i.nombre,className:"d-block mx-auto mb-2",style:{width:"100px",height:"100px",objectFit:"cover"}}),e.jsxs("p",{className:"mb-1",children:[e.jsx("strong",{children:"ID:"})," ",i.id]}),e.jsxs("p",{className:"mb-1",children:[e.jsx("strong",{children:"Nombre:"})," ",i.nombre]}),e.jsxs("p",{className:"mb-0",children:[e.jsx("strong",{children:"Ventas semanales:"})," ",i.ventasSemanales," unidades"]})]},i.id)):e.jsx("p",{className:"text-center w-100",children:"No hay productos disponibles."})})]})}function I(){const[l,t]=c.useState([]),[i,a]=c.useState([]),[s,r]=c.useState(()=>JSON.parse(localStorage.getItem("catalogoProductos"))||[]),[d,n]=c.useState("bandeja"),[h,x]=c.useState(null),[o,b]=c.useState(!1),j=y();c.useEffect(()=>{fetch("/mensajes.json").then(u=>u.json()).then(u=>t(u)).catch(u=>console.error("Error cargando mensajes:",u)),fetch("/personal.json").then(u=>u.json()).then(u=>a(u)).catch(u=>console.error("Error cargando empleados:",u))},[]);const p=()=>b(!o),m=()=>{localStorage.removeItem("usuarioActivo"),localStorage.removeItem("rol"),j("/inicio-sesion")},N=()=>{x(null),n("agregarProducto")},v=u=>{const g=h?s.map(f=>f.id===u.id?u:f):[...s,u];r(g),x(null),n("bandeja"),localStorage.setItem("catalogoProductos",JSON.stringify(g))},C=()=>{n("perfil"),b(!1)};return e.jsxs("div",{className:"admin-container",children:[e.jsx(S,{toggleOffcanvas:p}),e.jsx(w,{visible:o,toggleOffcanvas:p,setTabActivo:n,handleAgregarEmpleado:()=>n("empleados"),handleEditarEmpleado:()=>n("empleados"),handleAgregarProducto:N,abrirPerfil:C,logout:m}),e.jsxs("main",{className:"px-3 px-md-4 mt-3",children:[d==="bandeja"&&e.jsx(P,{mensajes:l}),d==="empleados"&&e.jsx(E,{empleados:i,setEmpleados:a}),(d==="agregarProducto"||d==="editarProducto")&&e.jsx(k,{productoEdit:h,handleGuardarProducto:v,cancelar:()=>n("bandeja")}),d==="perfil"&&e.jsx(F,{},"perfil"),d==="topProductos"&&e.jsx(q,{})]})]})}export{I as default};
